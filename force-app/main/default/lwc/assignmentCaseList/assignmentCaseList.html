<template>
    <article class="slds-card spacingCard" style="--sds-c-card-header-spacing-block-end: 0; --sds-c-card-body-spacing-block-start: 0;">
        <!-- 페이지 헤더 영역 -->
        <div class="slds-page-header" style="border: 1px solid rgb(201, 201, 201);">
            <!-- 페이지 헤더 행 -->
            <div class="slds-page-header__row">
                <!-- 제목 및 로고 영역 -->
                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <!-- 로고 이미지 -->
                            <img style="height: 40px; width: 40px;" src={loopy}>
                        </div>
                        <div class="slds-media__body">
                            <div class="slds-page-header__name">
                                <div class="slds-page-header__name-title">
                                    <!-- 페이지 제목 -->
                                    <h1>
                                        <span>Assignment Case</span>
                                        <span class="slds-page-header__title slds-truncate" title="Recently Viewed">Recently Viewed</span>
                                    </h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 페이지 헤더 액션 버튼 영역 -->
                <div class="slds-page-header__col-actions">
                    <div class="slds-page-header__controls">
                        <div class="slds-page-header__control">
                            <!-- 버튼 그룹 -->
                            <template if:true={isUser}>
                            <ul class="slds-button-group-list">
                                <li>
                                    <!-- New 버튼 -->
                                    <button class="slds-button slds-button_neutral" onclick={openModal}>New</button>
                                </li>
                                <li>
                                    <!-- delete 버튼 -->
                                    <lightning-button-menu alternative-text="Show menu" variant="border">
                                        <lightning-menu-item value="Delete" label="Delete" onclick={selectedDeleteAll}></lightning-menu-item>
                                    </lightning-button-menu>
                                </li>
                            </ul>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 페이지 헤더 하단 정보 영역 -->
            <div class="slds-page-header__row">
                <!-- 선택된 Case 수 정보 -->
                <div class="slds-page-header__col-meta">
                    <p class="slds-page-header__meta-text">Selected {countSelectLow} items</p>
                </div>
                <!-- 검색 및 컨트롤 영역 -->
                <div class="slds-page-header__col-controls">
                    <div class="slds-page-header__controls">
                        <!-- 필터 선택 영역 -->
                        <div class="slds-form-element slds-m-right_small">
                            <div class="slds-form-element__control">
                                <div class="slds-select_container">
                                    <select class="slds-select" id="searchFilter" onchange={getOption}>
                                        <option value="All">All</option>
                                        <option value="StatusAssignment__c">Status</option>
                                        <option value="AssignmentManager__r.Name">Manager</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-- 검색어 입력 필드 -->
                        <div class="slds-form-element">
                            <div class="slds-form-element__control">
                                <input type="text" id="searchInput" class="slds-input" placeholder="검색어 입력" onkeypress={handleSearch}>
                            </div>
                        </div>
                        <!-- 기타 컨트롤 버튼들 -->
                        <div class="slds-page-header__control">
                            <!-- 톱니바퀴 버튼 -->
                            <div class="slds-dropdown-trigger slds-dropdown-trigger_click">
                                <lightning-button-menu alternative-text="Show menu" variant="border-filled" icon-name="utility:settings">
                                    <lightning-menu-item value="1" label="1"></lightning-menu-item>
                                    <lightning-menu-item value="1" label="2"></lightning-menu-item>
                                </lightning-button-menu>
                            </div>
                        </div>
                        <!-- 테이블 버튼 -->
                        <div class="slds-page-header__control">
                            <div class="slds-dropdown-trigger slds-dropdown-trigger_click">
                                <lightning-button-menu alternative-text="Show menu" variant="border-filled" icon-name="utility:table">
                                    <lightning-menu-item value="1" label="1"></lightning-menu-item>
                                    <lightning-menu-item value="1" label="2"></lightning-menu-item>
                                </lightning-button-menu>
                            </div>
                        </div>
                        <!-- 새로고침 및 기타 버튼들 -->
                        <div class="slds-page-header__control">
                            <!-- 새로고침 아이콘 버튼 -->
                            <lightning-button-icon class="forceRefreshButton rotate" variant="border-filled" icon-name="utility:refresh" onclick={pageReload}>
                                <button class="slds-button slds-button_icon slds-button_icon-border-filled" title="Edit List">
                                </button>
                            </lightning-button-icon>
                        </div>
                        <div class="slds-page-header__control">
                            <!-- 새로고침 버튼 -->
                            <button class="slds-button slds-button_icon slds-button_icon-border-filled" title="Refresh List">
                                <span class="slds-assistive-text">Refresh List</span>
                            </button>
                        </div>
                        <!-- 차트 및 필터 버튼 그룹 -->
                        <div class="slds-page-header__control">
                            <ul class="slds-button-group-list">
                                <!-- 차트 버튼 -->
                                <li>
                                    <button class="slds-button slds-button_icon slds-button_icon-border-filled" title="Charts">
                                        <span class="slds-assistive-text">Charts</span>
                                    </button>
                                </li>
                                <!-- 필터 버튼 -->
                                <li>
                                    <button class="slds-button slds-button_icon slds-button_icon-border-filled" title="Filters">
                                        <span class="slds-assistive-text">Filters</span>
                                    </button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 데이터 테이블 영역 -->
        <div class="slds-card__body">
            <!-- 라이트닝 데이터 테이블 컴포넌트 -->
            <lightning-datatable key-field="Id" 
                data={assignmentCaseData} 
                columns={cols} 
                show-row-number-column="true"
                onrowselection={handleRowSelection}
                onrowaction={handleRowAction}
                sorted-by={sortBy}
                sorted-direction={sortDirection}
                onsort={doSorting}
                onsave={handleSave}
                draft-values={saveDraftValues}>
            </lightning-datatable>
        </div>
    </article>




    <template if:true={isModalOpen}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                        <lightning-icon icon-name="utility:close"
                            alternative-text="close"
                            variant="inverse"
                            size="small" ></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">New Assignment Case</h2>
                </header>
                <lightning-record-edit-form object-api-name="AssignmentCase__c" columns="2" onsubmit={handleSubmit} onsuccess={handleSuccess}>

                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size_12-of-12">
                                <h3 class="slds-section__title slds-theme_shade">
                                    <span class="slds-truncate slds-p-horizontal_small">Assignment Case Information</span>
                                </h3>
                            </div>
                            <div class="slds-col slds-size_6-of-12">
                                <lightning-input-field field-name="Case__c"></lightning-input-field>
                            </div>
                            <div class="slds-col slds-size_6-of-12">
                                <lightning-input-field field-name="AssignmentManager__c"></lightning-input-field>
                            </div>

                           
                            
                        </div>
                        
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick={closeModal} title="Cancel">Cancel</button>
                        <button class="slds-button slds-button_brand" type="submit" title="Save">Submit</button>
                    </footer>
                </lightning-record-edit-form>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>
